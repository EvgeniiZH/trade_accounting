{% extends 'base.html' %}
{% load static %}

{% block title %}–î–µ—Ç–∞–ª–∏ —Å–Ω–∏–º–∫–∞ —Ä–∞—Å—á—ë—Ç–∞{% endblock %}

{% block content %}
<div class="container-fluid page-wrapper">
    <div class="page-header">
        <h2 class="mb-0 text-primary">üìÑ –ü—Ä–æ—Å–º–æ—Ç—Ä –∞—Ä—Ö–∏–≤–Ω–æ–≥–æ —Ä–∞—Å—á—ë—Ç–∞</h2>
    </div>

    <div class="page-content">
    <div class="row g-4 h-100 overflow-hidden">
        <div class="col-12 col-xl-4 overflow-auto">
            <div class="card shadow-sm">
                <div class="card-body">
                    <p class="mb-2"><strong>–†–∞—Å—á—ë—Ç:</strong> {{ snapshot.calculation.title }}</p>
                    <p class="mb-2"><strong>–°–æ–∑–¥–∞–Ω:</strong> {{ snapshot.created_at|date:"d.m.Y H:i" }}</p>
                    <p class="mb-2"><strong>–°—Ç–æ–∏–º–æ—Å—Ç—å –±–µ–∑ –Ω–∞—Ü–µ–Ω–∫–∏:</strong> {{ snapshot.frozen_total_price|floatformat:2 }} ‚ÇΩ</p>
                    <p class="mb-0"><strong>–°—Ç–æ–∏–º–æ—Å—Ç—å —Å –Ω–∞—Ü–µ–Ω–∫–æ–π:</strong> {{ snapshot.frozen_total_price_with_markup|floatformat:2 }} ‚ÇΩ</p>
                </div>
            </div>
        </div>

        <div class="col-12 col-xl-8 overflow-hidden">
            <div class="input-group mb-3" data-table-search data-table-id="snapshot-detail-table" data-cell-selector=".search-target">
                <span class="input-group-text">üîç</span>
                <input type="text" class="form-control" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞..." data-role="search-input" data-focus-hotkey="/">
                <button type="button" class="btn btn-outline-secondary" data-role="clear-search">–û—á–∏—Å—Ç–∏—Ç—å</button>
            </div>

            <div class="table-scroll border rounded shadow-sm">
                <table class="table table-bordered table-hover mb-0" id="snapshot-detail-table">
                    <thead class="table-light">
                        <tr>
                            <th>ID —Ç–æ–≤–∞—Ä–∞</th>
                            <th>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</th>
                            <th class="text-end">–¶–µ–Ω–∞</th>
                            <th class="text-center">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                            <th class="text-end">–ò—Ç–æ–≥–æ</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in page_obj %}
                        <tr>
                            <td>{{ item.snapshot.id }}</td>
                            <td class="search-target">{{ item.item_name }}</td>
                            <td class="text-end">{{ item.item_price|floatformat:2 }}</td>
                            <td class="text-center">{{ item.quantity }}</td>
                            <td class="text-end">{{ item.total_price|floatformat:2 }}</td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="5" class="text-center text-muted">–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="page-footer mt-2">
                {% include 'includes/pagination.html' %}
            </div>
        </div>
    </div>

    <a href="{% url 'calculation_snapshot_list' %}" class="btn btn-secondary mt-3">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É —Å–Ω–∏–º–∫–æ–≤</a>
    </div>
</div>

<script src="{% static 'js/table_search.js' %}" defer></script>
{% endblock %}
