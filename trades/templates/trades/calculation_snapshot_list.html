{% extends 'base.html' %}
{% load static %}

{% block title %}–°–Ω–∏–º–∫–∏ —Ä–∞—Å—á—ë—Ç–æ–≤{% endblock %}

{% block content %}
    <div class="container-fluid page-wrapper">
        <div class="page-header d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3">
            <h2 class="mb-0 text-primary">üìÅ –ê—Ä—Ö–∏–≤ —Ä–∞—Å—á—ë—Ç–æ–≤</h2>
        </div>

        <div class="page-content">
        <div class="input-group" data-table-search data-table-id="snapshot-table" data-cell-selector=".search-target">
            <span class="input-group-text">üîç</span>
            <input type="text" class="form-control" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ –∞–≤—Ç–æ—Ä—É..." data-role="search-input" data-focus-hotkey="/">
            <button type="button" class="btn btn-outline-secondary" data-role="clear-search">–û—á–∏—Å—Ç–∏—Ç—å</button>
        </div>

        <div class="table-scroll border rounded shadow-sm">
            <table id="snapshot-table" class="table table-bordered table-hover mb-0">
                <thead class="table-light">
                <tr>
                    <th>ID</th>
                    <th>–†–∞—Å—á—ë—Ç</th>
                    <th>–ê–≤—Ç–æ—Ä</th>
                    <th class="text-center">–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</th>
                    <th class="text-end">–ù–∞—Ü–µ–Ω–∫–∞ (%)</th>
                    <th class="text-end">–°—Ç–æ–∏–º–æ—Å—Ç—å –±–µ–∑ –Ω–∞—Ü–µ–Ω–∫–∏</th>
                    <th class="text-end">–°—Ç–æ–∏–º–æ—Å—Ç—å —Å –Ω–∞—Ü–µ–Ω–∫–æ–π</th>
                    <th class="text-center">–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
                </thead>
                <tbody>
                {% for snapshot in page_obj %}
                    <tr>
                        <td>{{ snapshot.id }}</td>
                        <td class="search-target">{{ snapshot.calculation.title }}</td>
                        <td class="search-target">
                            {% if snapshot.created_by %}
                                {{ snapshot.created_by.username }}
                            {% else %}
                                –ù–µ —É–∫–∞–∑–∞–Ω
                            {% endif %}
                        </td>
                        <td class="text-center">{{ snapshot.created_at|date:"d.m.Y H:i" }}</td>
                        <td class="text-end">{{ snapshot.calculation.markup|floatformat:2 }}%</td>
                        <td class="text-end">{{ snapshot.frozen_total_price|floatformat:2 }} ‚ÇΩ</td>
                        <td class="text-end">{{ snapshot.frozen_total_price_with_markup|floatformat:2 }} ‚ÇΩ</td>
                        <td class="text-center">
                            <a href="{% url 'calculation_snapshot_detail' snapshot.id %}" class="btn btn-primary btn-sm">
                                –ü—Ä–æ—Å–º–æ—Ç—Ä
                            </a>
                        </td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="8" class="text-center text-muted">–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Å–Ω–∏–º–∫–æ–≤ —Ä–∞—Å—á—ë—Ç–æ–≤</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>

        <a href="{% url 'calculations_list' %}" class="btn btn-secondary mt-3">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É —Ä–∞—Å—á—ë—Ç–æ–≤</a>
        <div class="page-footer">
            {% include 'includes/pagination.html' %}
        </div>
        </div>
    </div>

    <link rel="stylesheet" href="{% static 'css/pages/calculation_snapshot_list.css' %}">
    <script src="{% static 'js/table_search.js' %}" defer></script>

{% endblock %}