<form method="post" action="{% url 'calculations_list' %}" class="d-flex flex-column h-100 gap-3">
    {% csrf_token %}
    <div class="table-scroll border rounded shadow-sm flex-grow-1">
        <!-- Loader -->
        <div class="table-loader">
            <div class="spinner"></div>
        </div>

        <table class="table table-bordered table-hover mb-0" id="calculation-table">
            <thead class="position-sticky top-0 z-1">
            <tr>
                <th class="text-center">#</th>
                <th><input type="checkbox" id="select_all"></th>

                <th>
                    <a href="?sort=title&direction={% if sort_by == 'title' and direction == 'asc' %}desc{% else %}asc{% endif %}{% if search %}&search={{ search }}{% endif %}"
                       class="sort-link {% if sort_by == 'title' %}{% if direction == 'asc' %}asc{% else %}desc{% endif %}{% endif %}">
                        Название
                    </a>
                </th>

                <th>Товаров</th>

                <th>
                    <a href="?sort=total_price&direction={% if sort_by == 'total_price' and direction == 'asc' %}desc{% else %}asc{% endif %}{% if search %}&search={{ search }}{% endif %}"
                       class="sort-link {% if sort_by == 'total_price' %}{% if direction == 'asc' %}asc{% else %}desc{% endif %}{% endif %}">
                        Стоимость
                    </a>
                </th>

                <th>
                    <a href="?sort=total_price_with_markup&direction={% if sort_by == 'total_price_with_markup' and direction == 'asc' %}desc{% else %}asc{% endif %}{% if search %}&search={{ search }}{% endif %}"
                       class="sort-link {% if sort_by == 'total_price_with_markup' %}{% if direction == 'asc' %}asc{% else %}desc{% endif %}{% endif %}">
                        С наценкой
                    </a>
                </th>

                <th>
                    <a href="?sort=created_at&direction={% if sort_by == 'created_at' and direction == 'asc' %}desc{% else %}asc{% endif %}{% if search %}&search={{ search }}{% endif %}"
                       class="sort-link {% if sort_by == 'created_at' %}{% if direction == 'asc' %}asc{% else %}desc{% endif %}{% endif %}">
                        Дата
                    </a>
                </th>

                <th>
                    <a href="?sort=user&direction={% if sort_by == 'user' and direction == 'asc' %}desc{% else %}asc{% endif %}{% if search %}&search={{ search }}{% endif %}"
                       class="sort-link {% if sort_by == 'user' %}{% if direction == 'asc' %}asc{% else %}desc{% endif %}{% endif %}">
                        Автор
                    </a>
                </th>
                <th>Действия</th>
            </tr>
            </thead>
            <tbody>
            {% include 'trades/includes/calculations_list_rows.html' %}
            </tbody>
        </table>
    </div>

    <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center gap-3 flex-shrink-0">
        <button type="submit" name="export_excel" value="1" class="btn btn-success">
            Экспорт в Excel
        </button>
    </div>
</form>

<div class="page-footer mt-3">
    {% include 'includes/pagination.html' %}
</div>
