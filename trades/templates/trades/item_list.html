{% extends 'base.html' %}

{% block title %}Список товаров{% endblock %}

{% block content %}
    <h2>Список товаров</h2>
    <form method="post">
        {% csrf_token %}
        <table border="1">
            <thead>
            <tr>
                <th>Наименование</th>
                <th>Цена</th>
                <th>Действия</th>
            </tr>
            </thead>
            <tbody>
            {% for item in items %}
                <tr>
                    <td>
                        <input type="text" name="name_{{ item.id }}" value="{{ item.name }}">
                    </td>
                    <td>
                        {% if user_settings %}
                            <input type="number" name="price_{{ item.id }}"
                                   value="{{ item.price|floatformat:user_settings.decimal_places_price }}"
                                   step="{{ user_settings.price_step|default:0.01 }}" min="0">

                        {% else %}
                            <input type="number" name="price_{{ item.id }}"
                                   value="{{ item.price|floatformat:2 }}"
                                   step="0.01">
                        {% endif %}
                    </td>
                    <td>
                        <button type="submit" name="edit_item" value="{{ item.id }}">Сохранить</button>
                        <button type="submit" name="delete_item" value="{{ item.id }}">Удалить</button>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>

    </form>

    <h3>Добавить новый товар</h3>
    <form method="post">
        {% csrf_token %}
        <input type="text" name="name" placeholder="Название" required>
        <input type="number" name="price" placeholder="Цена" step="0.01" required>
        <button type="submit" name="add_item">Добавить</button>
    </form>

    <h3>Загрузить товары из файла</h3>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <input type="file" name="file" accept=".xlsx, .xls">
        <button type="submit" name="upload_file">Загрузить</button>
    </form>

    <h3>Настройка шага изменения цены</h3>
    <form method="post">
        {% csrf_token %}
        <label for="price_step">Шаг изменения цены:</label>
        <input type="number" name="price_step" id="price_step"
               value="{{ user_settings.price_step|default:0.01 }}" step="0.01" min="0">
        <button type="submit" name="update_step">Сохранить шаг</button>
    </form>
{% endblock %}






